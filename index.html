<html>
<head>
<script src="lib/underscore-min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
<script type="text/javascript" src="src/data.js"></script>

<link rel="stylesheet" type="text/css" href="style.css">
<link rel="stylesheet" type="text/css" href="dbstyle.css">
</head>
<body>

<iframe id="dataFrame" src="data/page.html" style="display:none" onload="setup();"></iframe>

<div class="main">
<div class="title">Who Am I?</div>
<div id="header-border-div"></div>

<div>
<div id="current"> 
	<img id="headshot" style="width:250px"></img>
</div>
<div id="statsBar">
	<div id="numLeft"></div>
	
	<div id="score"></div>
	
	<div class="fraction">
	<div id="numRight"></div>
	<div class="bigSlash">/</div>
	<div id="numTotal"></div>
	</div>
</div>



</div>
</div>

<div class="buttonContainer">
	<div id="answerButtons" style="display:none">
		<div id="actualName"></div>
		<div class="submitButtons">
			<div id="gotIt"><a href="javascript:null">&#10004; [Y] Got it!</a></div>
			<div id="missedIt"><a href="javascript:null">[N] Missed it</a></div>
		</div>
	</div>
	
	<div id="reveal" class="button blue" style="margin-top: 10px">[R]eveal Name</div>
</div>

<script type="text/javascript">
var quiz    = null;
var current = null;

var right = 0;
var wrong = 0;

function next() {
	$("#answerButtons").hide();
	computeScore();
	
	if (!quiz) {
		alert("Uh oh-- error loading data!");
		return;
	}
	
	current = quiz.getNext();
	if (!current) {
		alert("You win!");
	}
	
	$("#headshot").attr("src", current.img);
};

function computeScore() {
	var pct = (right + wrong) ? Math.floor((right / (right + wrong)) * 100) : 0;
	$("#score").text(pct + "%");
	$("#numRight").text(right)
	$("#numTotal").text(right + wrong)

	var numLeft  = 0;
	if (quiz) {
		numLeft = quiz.teammates.length;
	}
	$("#numLeft").text(numLeft + " left");
};

function setup () {
	quiz = new Quiz($("#dataFrame"));	
	next();
};

function reveal() {
	$("#actualName").text(current.name);
	$("#answerButtons").show();
};

function gotIt() {
	right++;
	next();
}

function missedIt() {
	wrong++;
	next();
}

$("#reveal").on("click", reveal);

$("#gotIt").on("click", gotIt);
$("#missedIt").on("click", missedIt);

computeScore();


$(document).keydown(function(e) {
	switch (e.keyCode) {
	case 82:
		reveal();
		break;
	case 89:
		gotIt();
		break;
	case 78:
		missedIt();
		break;
	}
});
</script>
</body>
</html>